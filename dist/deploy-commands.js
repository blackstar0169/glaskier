var h=Object.create;var c=Object.defineProperty;var f=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var S=(e,t,o,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of g(t))!b.call(e,r)&&r!==o&&c(e,r,{get:()=>t[r],enumerable:!(n=f(t,r))||n.enumerable});return e};var l=(e,t,o)=>(o=e!=null?h(y(e)):{},S(t||!e||!e.__esModule?c(o,"default",{value:e,enumerable:!0}):o,e));var i=require("discord.js"),u=l(require("fs"));var m=l(require("dotenv"));var a=require("@discordjs/voice");function p(e){return e.toLowerCase().replace(/(-|_)./g,t=>t[1].toUpperCase())}var d=class{constructor(){this.config={};this.default={lang:"en",soundDir:"./sounds"};this.required=["nodeEnv","discordToken","discordClientId"]}init(){m.default.config({debug:!0});let t=this.populate(process.env),o=this.validate(t);if(o.length>0)throw new Error("Config error. Missing properties : "+o.join(", "));this.config=Object.assign({},this.default,t)}populate(t){let o={};for(let n in t)if(Object.hasOwnProperty.call(t,n)){let r=p(n);o[r]=t[n]}return o}validate(t){let o=[];for(let n=0;n<this.required.length;n++)(typeof t[this.required[n]]>"u"||t[this.required[n]]===null||t[this.required[n]]==="")&&o.push(this.required[n]);return o}get(t,o=void 0){return typeof this.config[t]<"u"?this.config[t]:o}set(t,o){return this.config[t]=o}isProd(){let t=this.get("nodeEnv","dev");return t==="prod"||t==="production"}},s=new d;u.default.existsSync(".env")||(console.error("Env file "+process.cwd()+"/.env not found."),process.exit(1));try{s.init()}catch(e){console.error(".env file parsing error",e),process.exit(2)}var D=s.get("discordToken"),w=s.get("discordClientId"),N=new i.SlashCommandBuilder().setName("gla").setDescription("Interact with glaskier").addSubcommand(e=>e.setName("help").setDescription("List commands")).addSubcommand(e=>e.setName("stop").setDescription("Stop the bot to play random sounds")).addSubcommand(e=>e.setName("start").setDescription("Start the bot to play random sounds")).addSubcommand(e=>e.setName("next").setDescription("Display the date and in which channel the next song will be played")).addSubcommand(e=>e.setName("reroll").setDescription("Generate a new random time to play a song")).addSubcommand(e=>e.setName("test").setDescription("Play a song in your channel. Don't interupte the next random traget")).addSubcommand(e=>e.setName("history").setDescription("List the last 50 glitch")).addSubcommand(e=>e.setName("debug").setDescription("Debug command. Only available for the creator.").addStringOption(t=>t.setName("option").setDescription("The option to debug").setRequired(!0).addChoices({name:"Play",value:"play"},{name:"Get user ID",value:"getUserId"}))).addSubcommand(e=>e.setName("play").setDescription("Play a binded sound if there is a key or a random sound").addStringOption(t=>t.setName("key").setDescription("The binded key").setRequired(!0)).addStringOption(t=>t.setName("channel").setDescription("The where to play the sound"))).addSubcommand(e=>e.setName("list-sounds").setDescription("List sounds")).addSubcommand(e=>e.setName("list-channels").setDescription("List voice channels")),v=new i.REST().setToken(D);try{console.log("Started refreshing application (/) commands."),v.put(i.Routes.applicationCommands(w),{body:[N.toJSON()]}).then(e=>{Array.isArray(e)?console.log(`Successfully reloaded ${e.length} application (/) commands.`):(console.error("Error while reloading application (/) commands."),console.error(e))}).catch(e=>{console.error("Error while reloading application (/) commands."),console.error(e)})}catch(e){console.error(e)}
